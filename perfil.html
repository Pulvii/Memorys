<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tiktok Profile Page</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-storage.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
</head>
<body>

    <header class="navbar" >
        <div>
            <div class="left">
                <p id="titulo">MEMORIES</p>
            </div>
            <div class="right">
                <i class="fas fa-bars" id="menu-toggle"></i>
                <i class="fas fa-bars" id="menu-toggle2" style="display: none; position: fixed;"></i>
            </div>
        </div>
    </header>

    <div id="sidebar" style="right: 100%; display: none;" >
        <div class="profile">
            <center>
                <div id="fotoPerfil" class="w-20 h-20 bg-cover bg-top bg-no-repeat rounded-full" style="background-image: url(imagenoencontrada.jpg);">

                  </div>
                  
            </center>
            <h2 id="nombreUsuario">Usuario</h2>
            <div class="user-info">
                <span id="seguidores">Seguidores: 1000</span>
                <span id="seguidos">Seguidos: 500</span>
            </div>
            <ul class="nav-list">
                <li><a href="index.html">Inicio</a></li>
                <li><a href="perfil.html">Perfil</a></li>
                <li><a href="#">Agregar Amigos</a></li>
                <li><a href="#">Opciones</a></li>
                <li><a href="IniciarSesion.html" onclick=borrarDatos()>Cerrar Sesion</a></li>
            </ul>
        </div>
    </div>
    
 
    <br>


<div class="relative max-w-2xl mx-auto my-3">
    <!-- top navbar -->
    <div class="flex justify-between items-center text-sm">
        <div class="flex gap-1 px-4">

        </div>
        <a href="#" class="flex gap-1 items-center">
            <span id="nombreUsuario2" class="font-bold text-[17px]">Usuario</span>
        </a>
        <div class="flex gap-1 px-4">
            <button>

            </button>
        </div>
    </div>
    <!-- top navbar end -->
 
    <!-- top header -->
    <div class="flex flex-col justify-center items-center my-5">
        <div id="fotoPerfil2" class="w-20 h-20 bg-cover bg-top bg-no-repeat rounded-full" style="background-image: url(imagenoencontrada.jpg);"></div>
        <input type="file" id="cargarFotoPerfil" accept="image/*" style="display: none;">
       

        <label for="cargarFotoPerfil" style="cursor: pointer;">
          <i class="fas fa-camera"></i> 
        </label>
        
        <span class="my-3"></span>
 
        <div class="flex gap-10 text-sm">
            <div class="flex flex-col items-center">
                <span id="seguidos2" class="font-bold">16</span>
                <span style="color:#8A8B8F">Following</span>
            </div>
            <div class="flex flex-col items-center">
                <span id="seguidores2" class="font-bold">2</span>
                <span style="color:#8A8B8F">Followers</span>
            </div>
 
        </div>

        <div class="grid grid-cols-1">
            <button class="my-5 px-5 py-2 font-semibold text-sm border border-gray-400">Editar perfil</button>
            </button>
        </div>
 
        <center><p class="mb-3">Me gusta programar y las computadoras</p></center>
    </div>
    <!-- top header end -->
 
 
    <!-- middle navigation -->
    <div class="grid grid-cols-3">
        <button class="mx-auto">
            <svg width="15" height="16" viewBox="0 0 15 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M2.5 0.5C2.5 0.223858 2.27614 0 2 0H1C0.723858 0 0.5 0.223858 0.5 0.5V6.5C0.5 6.77614 0.723858 7 1 7H2C2.27614 7 2.5 6.77614 2.5 6.5V0.5Z" fill="black"/>
                <path d="M2.5 9.5C2.5 9.22386 2.27614 9 2 9H1C0.723858 9 0.5 9.22386 0.5 9.5V15.5C0.5 15.7761 0.723858 16 1 16H2C2.27614 16 2.5 15.7761 2.5 15.5V9.5Z" fill="black"/>
                <path d="M8 9C8.27614 9 8.5 9.22386 8.5 9.5V15.5C8.5 15.7761 8.27614 16 8 16H7C6.72386 16 6.5 15.7761 6.5 15.5V9.5C6.5 9.22386 6.72386 9 7 9H8Z" fill="black"/>
                <path d="M8.5 0.5C8.5 0.223858 8.27614 0 8 0H7C6.72386 0 6.5 0.223858 6.5 0.5V6.5C6.5 6.77614 6.72386 7 7 7H8C8.27614 7 8.5 6.77614 8.5 6.5V0.5Z" fill="black"/>
                <path d="M14 9C14.2761 9 14.5 9.22386 14.5 9.5V15.5C14.5 15.7761 14.2761 16 14 16H13C12.7239 16 12.5 15.7761 12.5 15.5V9.5C12.5 9.22386 12.7239 9 13 9H14Z" fill="black"/>
                <path d="M14.5 0.5C14.5 0.223858 14.2761 0 14 0H13C12.7239 0 12.5 0.223858 12.5 0.5V6.5C12.5 6.77614 12.7239 7 13 7H14C14.2761 7 14.5 6.77614 14.5 6.5V0.5Z" fill="black"/>
            </svg>
        </button>
        <button class="mx-auto">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
                <path stroke-linecap="round" stroke-linejoin="round" d="M17.593 3.322c1.1.128 1.907 1.077 1.907 2.185V21L12 17.25 4.5 21V5.507c0-1.108.806-2.057 1.907-2.185a48.507 48.507 0 0111.186 0z" />
            </svg>              
        </button>
        <button class="mx-auto">
            <svg width="20" height="18" viewBox="0 0 20 18" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M4.3166 2.36224C2.84322 2.75154 1.75 3.99138 1.75 5.49999C1.75 6.27149 2.04087 7.15823 2.58398 8.12751C3.12337 9.09016 3.88226 10.0824 4.74694 11.0508C6.29123 12.7803 8.11993 14.3756 9.5 15.5261C9.69958 15.3597 9.90855 15.184 10.1247 15C10.31 14.8422 10.5818 14.8389 10.7698 14.9935L11.1631 15.3171C11.402 15.5136 11.407 15.8776 11.1718 16.0785C10.738 16.4488 10.3339 16.7847 9.97678 17.0788C9.69984 17.3069 9.30016 17.3069 9.02322 17.0788C7.60316 15.9094 5.43987 14.0789 3.62806 12.0498C2.72191 11.035 1.88704 9.95232 1.2754 8.86073C0.667465 7.77577 0.25 6.62896 0.25 5.49999C0.25 3.20768 1.90678 1.4475 3.9334 0.912008C5.76106 0.42909 7.87954 0.927122 9.5 2.76843C11.1205 0.927123 13.2389 0.429109 15.0666 0.912047C17.0932 1.44756 18.75 3.20776 18.75 5.50007C18.75 5.90977 18.695 6.32183 18.5959 6.73242C18.5186 7.05263 18.1432 7.17659 17.871 6.99108L17.4057 6.67394C17.2308 6.55474 17.153 6.33882 17.1906 6.13053C17.23 5.91283 17.25 5.70248 17.25 5.50007C17.25 3.99145 16.1568 2.7516 14.6834 2.36227C13.2565 1.98523 11.4538 2.42128 10.124 4.41593L9.91602 4.72794C9.71811 5.0248 9.28189 5.0248 9.08398 4.72794L8.87597 4.41593C7.54618 2.42128 5.74348 1.98521 4.3166 2.36224Z" fill="#D7D7D9"/>
                <path fill-rule="evenodd" clip-rule="evenodd" d="M10.5581 7.05806C10.8021 6.81398 11.1979 6.81398 11.4419 7.05806L18.4419 14.0581C18.686 14.3021 18.686 14.6979 18.4419 14.9419C18.1979 15.186 17.8021 15.186 17.5581 14.9419L16.7766 14.1605C16.0559 14.471 15.2743 14.6249 14.5 14.6249C12.4747 14.6249 10.3993 13.5719 9.49366 11.4178C9.38167 11.1515 9.38167 10.8485 9.49366 10.5821C9.86365 9.70205 10.4289 9.0058 11.1062 8.49004L10.5581 7.94194C10.314 7.69786 10.314 7.30214 10.5581 7.05806ZM12.0011 9.38499L15.8034 13.1873C15.3843 13.312 14.9441 13.3749 14.5 13.3749C12.9091 13.3749 11.3669 12.5679 10.6747 11C10.977 10.3152 11.4414 9.77564 12.0011 9.38499Z" fill="#D7D7D9"/>
                <path d="M17.8155 11.8477C18.0151 11.5957 18.1871 11.313 18.3253 11C17.6331 9.43205 16.0909 8.62501 14.5 8.625C14.4585 8.625 14.4171 8.62555 14.3757 8.62664C14.305 8.62851 14.2363 8.60239 14.1863 8.55242L13.4809 7.84705C13.3424 7.70854 13.4104 7.47392 13.604 7.44394C13.9012 7.39793 14.2011 7.375 14.5 7.375C16.5253 7.37501 18.6007 8.428 19.5063 10.5821C19.6183 10.8485 19.6183 11.1515 19.5063 11.4178C19.3001 11.9084 19.0331 12.3419 18.7199 12.7188C18.6292 12.8281 18.4649 12.831 18.3645 12.7306L17.8302 12.1964C17.7363 12.1024 17.733 11.9519 17.8155 11.8477Z" fill="#D7D7D9"/>
            </svg>
        </button>
    </div>
    <!-- middle navigation end -->
 
    <!-- Content grid -->
<!-- Content grid -->
<div class="grid grid-cols-3 gap-2.5 mt-2">
    <div class="card">
      <img src="MicrosoftTeams-image(1).jpeg" class="card-img-top img-fixed-size" alt="...">
    </div>
    <div class="card">
      <img src="MicrosoftTeams-image(2).jpeg" class="card-img-top img-fixed-size" alt="...">
    </div>
    <div class="card">
      <img src="MicrosoftTeams-image.jpeg" class="card-img-top img-fixed-size" alt="...">
    </div>
    <div class="card">
      <img src="descarga.png" class="card-img-top img-fixed-size" alt="...">
    </div>
    <div class="card">
      <img src="MicrosoftTeams-image.jpeg" class="card-img-top img-fixed-size" alt="...">
    </div>
    <div class="card">
        <img src="borrar.png" class="card-img-top img-fixed-size" alt="...">
      </div>
      <div class="card">
        <img src="camara.png" class="card-img-top img-fixed-size" alt="...">
      </div>
  </div>
<style>.img-fixed-size {
    width: 200px; /* Establece el ancho deseado para todas las imágenes */
    height: 150px; /* Establece la altura deseada para todas las imágenes */
    object-fit: cover; /* Opcional: para ajustar la imagen en el tamaño especificado */
  }
  </style>  
<!-- video grid end -->

 
 
</div>

<script>const firebaseConfig = {
    apiKey: "AIzaSyCpfhOnjmnpqGriQ2gnCEt0gSnWPJw63qI",
    authDomain: "memorys-c7164.firebaseapp.com",
    projectId: "memorys-c7164",
    storageBucket: "memorys-c7164.appspot.com",
    messagingSenderId: "287007507996",
    appId: "1:287007507996:web:5408ee2a2c78b72ea941d9",
    measurementId: "G-LRBSYE2205"
  };
  
  const app = firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();
  
  var usuario = localStorage.getItem("nombreUsuario");

  if (usuario) {
    // Realiza una consulta para obtener los seguidores y seguidos del usuario
    const usuariosRef = db.collection('Usuario');
    usuariosRef.where('usuario', '==', usuario)
      .get()
      .then((querySnapshot) => {
        if (querySnapshot.size > 0) {
          const userData = querySnapshot.docs[0].data();
          
          const fotoPerfil = userData.fotoDePerfil;
          // Obtén los seguidores y seguidos del usuario
          const seguidores = userData.seguidores;
          const seguidos = userData.seguidos;
          // Almacena los datos en el LocalStorage
          localStorage.setItem("seguidores", JSON.stringify(seguidores));
          localStorage.setItem("seguidos", JSON.stringify(seguidos));
          localStorage.setItem("fotoPerfil", fotoPerfil);
        } else {
          console.log("Usuario no encontrado en la base de datos");
        }
      })
      .catch((error) => {
        console.error('Error al consultar la base de datos:', error);
      });
  } else {
    // Maneja el caso en el que el usuario no tiene un nombre de usuario en el LocalStorage
    console.log("Usuario no autenticado");
  }

  var seguidores = localStorage.getItem("seguidores");
  var seguidos = localStorage.getItem("seguidos");
  var fotoPerf = localStorage.getItem("fotoPerfil");

  document.getElementById("nombreUsuario").innerHTML = usuario;
  document.getElementById("nombreUsuario2").innerHTML = usuario;
  document.getElementById("seguidores").innerHTML = "Seguidores: " + seguidores;
  document.getElementById("seguidos").innerHTML = "Seguidos: " + seguidos;
  document.getElementById("seguidos2").innerHTML = seguidos;
  document.getElementById("seguidores2").innerHTML = seguidores;
  document.getElementById("fotoPerfil").style.backgroundImage = `url(${fotoPerf})`;
  document.getElementById("fotoPerfil2").style.backgroundImage = `url(${fotoPerf})`;








  const cargarFotoPerfil = document.getElementById("cargarFotoPerfil");

cargarFotoPerfil.addEventListener("change", async (e) => {
  const file = e.target.files[0];
  if (file) {
    // Subir la imagen a Firebase Storage
    try {
      const storageRef = firebase.storage().ref();
      const imageRef = storageRef.child(`fotosPerfil/${usuario}/${file.name}`);
      await imageRef.put(file);

      // Obtener la URL de descarga de la imagen
      const imagenURL = await imageRef.getDownloadURL();

      // Almacenar la URL en la base de datos Firestore
      const usuariosRef = db.collection('Usuario');
      await usuariosRef.doc(usuario).update({
        fotoDePerfil: imagenURL
      });

      // Actualizar la imagen en la página
      const fotoPerfil = document.getElementById("fotoPerfil");
      fotoPerfil.style.backgroundImage = `url(${imagenURL})`;
      fotoPerfil2.style.backgroundImage = `url(${imagenURL})`;
    } catch (error) {
      console.error('Error al cargar la imagen:', error);
    }
  }
});
function borrarDatos() {
    localStorage.clear();
  }

</script>

<script src="navbar.js"></script>
</body>
</html>
